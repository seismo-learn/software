简介
====

SOD，全称是 Standing Order for Data，可以自动筛选并下载地震、台站和波形数据，
并对地震波形数据做预处理。其具有高度可定制化的特点，可以满足日常科研中
地震数据申请的大部分需求。

特色功能
--------

从 IRIS 上申请数据的工具有很多，比如 Wilber、BREQ_FAST，为什么要用 SOD 呢? SOD 有哪些优势呢？

先回顾一下申请地震波形数据的一般流程：

1. 获取完整的地震目录，并根据实际需求筛选出自己需要的地震目录
2. 获取台站列表，根据需求对震中距、方位角等进行筛选
3. 根据发震时刻、震中距、震相走时等信息确定要申请的波形数据的起始、结束时间
4. 申请数据
5. 下载数据
6. 数据解压以及预处理

以上提到的每个步骤都需要用户写一个以上的脚本来实现，如果需求改变，则可能需要修改多个脚本，总的来说是件很麻烦的事情。

SOD 的优势如下：

1. 只需要一个配置文件（SOD中称为recipe）即可完成上面提到的全部步骤
2. 灵活的地震筛选规则：

   - 可以在 IRIS/USGS 提供的地震目录的基础上根据发震时刻、深度、震级、震源所在区域等条件进行筛选
   - 可以由用户自行提供地震目录（需要满足 SOD 对地震目录的格式要求）
   - 可以构建虚拟地震以申请连续波形数据
   - ...

3. 灵活的台站筛选规则：

   - 可以选择一个或多个指定的台网、台站或通道
   - 可以筛选在某个特定点的特定距离、方位角、反方位角内的台站
   - 可以筛选某个区域内的台站
   - 可以下载指定通道的仪器响应文件（SAC PZ 和 RESP）
   - ...

4. 灵活的波形筛选规则：

   - 仅下载震中距、方位角、反方位角满足条件的数据
   - 仅当某个震相存在时才下载该台站的数据（比如仅当震中距大于115时才有PKIKP震相）
   - 仅当地震与台站的连线中点位于某个区域是才下载数据（比如想要用PcP研究某个特定区域的核幔边界结构）
   - 仅当指定震相的前后多少秒内没有其他震相干扰时才下载数据
   - 灵活的时窗截取规则，可自动计算理论到时以设置数据窗
   - 可直接生成 BREQ_FAST 文件以通过邮件方式申请数据
   - 以 miniSEED、SAC、ASCII、wav 格式将数据保存到磁盘中
   - ...

5. 数据并行下载，速度快无延迟
6. 将数据写入磁盘前/后，可对数据进行常见的数据预处理：

   - rmean, rtrend, taper, merge
   - decimate
   - differentiate, integrate
   - filter, transfer
   - phaseCut
   - ...

SOD 除了上面提到的功能/优点外，还有一个优点：入门很容易，别人写的 recipe 一看就懂，
改起来也简单，但一个很明显的缺点是：自己从头写一个 recipe 很困难，因为 SOD 其实是个很复杂的东西。

引用
----

- Owens, T. J., Crotwell, H. P., Groves, C., & Oliver-Paul, P. (2004).
  SOD: STANDING ORDER FOR DATA.
  *Seismological Research Letters*, 75(4), 515–520.
  https://doi.org/10.1785/gssrl.75.4.515-a
